======================================================================
TOV Star Evolution - Cowling Approximation
======================================================================
======================================================================
ATMOSPHERE CONFIGURATION
======================================================================
  rho_floor = 1.00e-10
  p_floor   = 1.00e-11
  tau_atm   = 1.00e-11
  v_max     = 0.9999

Grid: N=700, r_max=16.0, dr_min=0.02297200287149792
EOS: K=100.0, Gamma=2.0

Solving TOV equations on fine independent grid...
  TOV grid: 700 points, dr = 2.285714e-02
TOV Solution: M=1.400155, R=9.577, C=0.1462

Creating initial data via high-order interpolation...
  Interpolating TOV to evolution grid (order 11)...
  Stellar radius: R = 9.577243
  Initial data created via interpolation
  Applied atmosphere buffer: 4 cells beyond R on +r side

[Valencia debug] First interior cell diagnostics:
  i0=3, r=1.148600e-02
  Faces kL=2, kR=3 (len faces=699)
    F_D_face[kL:kR]    = [np.float64(0.0), np.float64(9.145588456472354e-14)]
    F_tau_face[kL:kR]  = [np.float64(0.0), np.float64(2.3412949279655713e-14)]
    F_S_face_r[kL:kR]  = [np.float64(0.00010974965491995584), np.float64(0.00010974870388462584)]
  Center densitization: alpha=6.698620e-01, e6phi=1.000001e+00
    fD_U[i0,0]   = 0.000000e+00
    fTau_U[i0,0] = 0.000000e+00
    F_S_c_r[i0]  = 1.097497e-04
  Gamma_trace_r[i0] = 1.741250e+02
  Face params: alpha_f[kL:kR]=[np.float64(0.6698620123658481), np.float64(0.6698634454958927)], e6phi_f[kL:kR]=[np.float64(1.0000007966867557), np.float64(1.0000039888762695)]
  Reconstructed at kL: rhoL=1.279997e-03, vL=0.000000e+00, pL=1.638391e-04
  Reconstructed at kL: rhoR=1.279997e-03, vR=0.000000e+00, pR=1.638391e-04

[Valencia debug] Source-term internals (first interior cell):
  r[i0]=1.148600e-02, alpha=6.698620e-01, e6phi=1.000001e+00 (≈√γ)
  v_theta=0.000000e+00, v_phi=0.000000e+00
  T4UU[θθ]=1.241880e+00, T4UU[φφ]=1.241880e+00
  hatD_gamma_LL[r,θ,θ]=1.148981e-17, hatD_gamma_LL[r,φ,φ]=1.148981e-17
  dalpha_dr=6.239018e-05

Initial RHS diagnostics (t=0):
  max |dS_r/dt| at r=0.011486 (i=3) -> -3.343e-08
  max |dD/dt|   = 9.641e-09
  max |dτ/dt|   = 1.538e-10
  estimated stellar surface near r=9.567839 (i=419)
  dS_r/dt in 11-pt window around surface:
    i=  414, r= 9.45298, dS_r/dt=-7.134e-10
    i=  415, r= 9.47595, dS_r/dt= 1.205e-09
    i=  416, r= 9.49892, dS_r/dt=-6.339e-10
    i=  417, r= 9.52190, dS_r/dt= 3.270e-10
    i=  418, r= 9.54487, dS_r/dt=-1.160e-10
    i=  419, r= 9.56784, dS_r/dt=-1.826e-09
    i=  420, r= 9.59081, dS_r/dt= 4.127e-09
    i=  421, r= 9.61378, dS_r/dt=-3.732e-10
    i=  422, r= 9.63676, dS_r/dt= 3.245e-10
    i=  423, r= 9.65973, dS_r/dt=-2.578e-12
    i=  424, r= 9.68270, dS_r/dt=-2.563e-12
Hydrostatic residual: max |res|=5.866e-09, mean=7.812e-12, std=3.851e-10

Evolving with fixed dt=0.003446 (CFL=0.1) for 10 steps using RK4

================================================================================
FIRST STEP ANALYSIS: Changes from t=0 to t=1×dt
================================================================================

Stellar radius R = 9.5772 at grid index 419 (r = 9.5678)

--------------------------------------------------------------------------------
CENTER (r≈0): r = 0.011486 (index 3)
--------------------------------------------------------------------------------

PRIMITIVE VARIABLES:
  ρ₀:     1.27999665e-03 → 1.27999668e-03   Δrel = 2.410576e-08
  P:      1.63839068e-04 → 1.63839068e-04   Δrel = 0.000000e+00
  vʳ:     0.00000000e+00 → -7.13802567e-08   Δabs = -7.138026e-08

CONSERVATIVE VARIABLES:
  D:      1.27999665e-03 → 1.27999668e-03   Δrel = 2.410576e-08
  Sʳ:     0.00000000e+00 → -1.14756429e-10   Δabs = -1.147564e-10
  τ:      1.63839142e-04 → 1.63839138e-04   Δrel = -2.119533e-08

BSSN VARIABLES:
  φ:      1.32781073e-07 → 1.32781073e-07   Δrel = 0.000000e+00
  α:      6.69862012e-01 → 6.69862012e-01   Δrel = 0.000000e+00
  hʳʳ:    1.06224915e-06 → 1.06224915e-06   Δrel = 0.000000e+00
  K:      0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00
  aʳʳ:    0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00

DERIVED QUANTITIES:
  M(r):   1.12115252e-06 → 1.12115252e-06   Δrel = 1.463414e-09
  ε:      1.27999607e-01 → 1.27999604e-01   Δrel = -2.410576e-08
  h:      1.25599921e+00 → 1.25599921e+00   Δrel = -4.913263e-09

--------------------------------------------------------------------------------
LEFT INTERIOR: r = 0.241206 (index 13)
--------------------------------------------------------------------------------

PRIMITIVE VARIABLES:
  ρ₀:     1.27851951e-03 → 1.27851951e-03   Δrel = -2.150563e-13
  P:      1.63461141e-04 → 1.63461141e-04   Δrel = 0.000000e+00
  vʳ:     0.00000000e+00 → 1.12834465e-11   Δabs = 1.128345e-11

CONSERVATIVE VARIABLES:
  D:      1.27851951e-03 → 1.27851951e-03   Δrel = -2.150563e-13
  Sʳ:     0.00000000e+00 → 1.81276648e-14   Δabs = 1.812766e-14
  τ:      1.63461214e-04 → 1.63461214e-04   Δrel = 9.236145e-14

BSSN VARIABLES:
  φ:      5.86205335e-05 → 5.86205335e-05   Δrel = 0.000000e+00
  α:      6.70019610e-01 → 6.70019610e-01   Δrel = 0.000000e+00
  hʳʳ:    4.69074249e-04 → 4.69074249e-04   Δrel = 0.000000e+00
  K:      0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00
  aʳʳ:    0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00

DERIVED QUANTITIES:
  M(r):   7.66274771e-05 → 7.66274771e-05   Δrel = 1.806208e-11
  ε:      1.27851894e-01 → 1.27851894e-01   Δrel = 2.149207e-13
  h:      1.25570379e+00 → 1.25570379e+00   Δrel = 4.349989e-14

--------------------------------------------------------------------------------
STELLAR SURFACE: r = 9.567839 (index 419)
--------------------------------------------------------------------------------

PRIMITIVE VARIABLES:
  ρ₀:     1.91904457e-06 → 1.91903382e-06   Δrel = -5.599087e-06
  P:      4.61807918e-10 → 4.61807918e-10   Δrel = 0.000000e+00
  vʳ:     0.00000000e+00 → -2.29553005e-06   Δabs = -2.295530e-06

CONSERVATIVE VARIABLES:
  D:      1.91904457e-06 → 1.91903382e-06   Δrel = -5.599084e-06
  Sʳ:     0.00000000e+00 → -6.23067705e-12   Δabs = -6.230677e-12
  τ:      3.68266406e-10 → 3.68267628e-10   Δrel = 3.317534e-06

BSSN VARIABLES:
  φ:      2.88555772e-02 → 2.88555772e-02   Δrel = 0.000000e+00
  α:      8.41023464e-01 → 8.41023464e-01   Δrel = 0.000000e+00
  hʳʳ:    2.59663495e-01 → 2.59663495e-01   Δrel = 0.000000e+00
  K:      0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00
  aʳʳ:    0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00

DERIVED QUANTITIES:
  M(r):   1.31854492e+00 → 1.31854492e+00   Δrel = 1.035006e-10
  ε:      2.40644707e-04 → 2.40646054e-04   Δrel = 5.599119e-06
  h:      1.00048129e+00 → 1.00048129e+00   Δrel = 2.693500e-09

--------------------------------------------------------------------------------
FAR BOUNDARY: r = 15.931084 (index -4)
--------------------------------------------------------------------------------

PRIMITIVE VARIABLES:
  ρ₀:     1.00000000e-10 → 1.00000000e-10   Δrel = 0.000000e+00
  P:      1.10000000e-11 → 1.10000000e-11   Δrel = 0.000000e+00
  vʳ:     0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00

CONSERVATIVE VARIABLES:
  D:      1.00000000e-10 → 1.00000000e-10   Δrel = 0.000000e+00
  Sʳ:     0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00
  τ:      1.00000000e-11 → 1.00000000e-11   Δrel = 0.000000e+00

BSSN VARIABLES:
  φ:      1.61094658e-02 → 1.61094658e-02   Δrel = 0.000000e+00
  α:      9.07867538e-01 → 9.07867538e-01   Δrel = 0.000000e+00
  hʳʳ:    1.37548748e-01 → 1.37548748e-01   Δrel = 0.000000e+00
  K:      0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00
  aʳʳ:    0.00000000e+00 → 0.00000000e+00   Δabs = 0.000000e+00

DERIVED QUANTITIES:
  M(r):   1.31857160e+00 → 1.31857160e+00   Δrel = -4.174246e-12
  ε:      1.10000000e-01 → 1.10000000e-01   Δrel = 0.000000e+00
  h:      1.22000000e+00 → 1.22000000e+00   Δrel = 0.000000e+00

================================================================================
GLOBAL STATISTICS:
================================================================================

Max relative changes (interior points):
  ρ₀:     5.599087e-06
  P:      0.000000e+00
  φ:      0.000000e+00
  α:      0.000000e+00
  |vʳ|:   2.295530e-06

Locations of maximum changes:
  Max Δρ/ρ at r = 9.567839 (index 419)
  Max ΔP/P at r = 0.011486 (index 3)
  Max |vʳ| at r = 9.567839 (index 419)
================================================================================


Evolving to step 10...

===== Evolution diagnostics (per step) =====
Columns: step | t | ρ_central | max_Δρ/ρ | max_vʳ | max_D | max_Sʳ | max_τ | c2p_fails
----------------------------------------------------------------------------------------------------
step    1  t=3.445800e-03:  ρ_c=1.279997e-03  max_Δρ/ρ=5.597e-06  max_vʳ=2.274e-06  max_D=1.280e-03  max_Sʳ=1.148e-10  max_τ=1.638e-04  c2p_fail=0
step    2  t=6.891601e-03:  ρ_c=1.279997e-03  max_Δρ/ρ=1.159e-05  max_vʳ=4.546e-06  max_D=1.280e-03  max_Sʳ=2.287e-10  max_τ=1.638e-04  c2p_fail=0
step    3  t=1.033740e-02:  ρ_c=1.279997e-03  max_Δρ/ρ=1.797e-05  max_vʳ=6.814e-06  max_D=1.280e-03  max_Sʳ=3.417e-10  max_τ=1.638e-04  c2p_fail=0
step    4  t=1.378320e-02:  ρ_c=1.279997e-03  max_Δρ/ρ=2.474e-05  max_vʳ=9.079e-06  max_D=1.280e-03  max_Sʳ=4.539e-10  max_τ=1.638e-04  c2p_fail=0
step    5  t=1.722900e-02:  ρ_c=1.279997e-03  max_Δρ/ρ=3.190e-05  max_vʳ=1.134e-05  max_D=1.280e-03  max_Sʳ=5.653e-10  max_τ=1.638e-04  c2p_fail=0
step    6  t=2.067480e-02:  ρ_c=1.279998e-03  max_Δρ/ρ=3.944e-05  max_vʳ=1.360e-05  max_D=1.280e-03  max_Sʳ=6.759e-10  max_τ=1.638e-04  c2p_fail=0
step    7  t=2.412060e-02:  ρ_c=1.279998e-03  max_Δρ/ρ=4.738e-05  max_vʳ=1.586e-05  max_D=1.280e-03  max_Sʳ=7.857e-10  max_τ=1.638e-04  c2p_fail=0
step    8  t=2.756640e-02:  ρ_c=1.279999e-03  max_Δρ/ρ=5.571e-05  max_vʳ=1.811e-05  max_D=1.280e-03  max_Sʳ=8.973e-10  max_τ=1.638e-04  c2p_fail=0
step    9  t=3.101220e-02:  ρ_c=1.279999e-03  max_Δρ/ρ=6.427e-05  max_vʳ=2.036e-05  max_D=1.280e-03  max_Sʳ=1.011e-09  max_τ=1.638e-04  c2p_fail=0
step   10  t=3.445800e-02:  ρ_c=1.280000e-03  max_Δρ/ρ=7.321e-05  max_vʳ=2.260e-05  max_D=1.280e-03  max_Sʳ=1.127e-09  max_τ=1.638e-04  c2p_fail=0
  -> Reached step 10, t=3.445800e-02

======================================================================
BSSN VARIABLES VERIFICATION (Cowling Approximation)
======================================================================
Maximum absolute changes (should be ~0 for frozen spacetime):

  φ         : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  α         : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  K         : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  h_rr      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  h_θθ      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  h_φφ      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  A_rr      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  A_θθ      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00
  A_φφ      : max |Δ| = 0.000000e+00  max |Δ/val| = 0.000000e+00

Spherical symmetry verification (should be ~0):
  max |h_θθ - h_φφ| at t=0.000000e+00: 0.000000e+00
  max |A_θθ - A_φφ| at t=0.000000e+00: 0.000000e+00
  max |h_θθ - h_φφ| at t=3.445800e-02: 0.000000e+00
  max |A_θθ - A_φφ| at t=3.445800e-02: 0.000000e+00
======================================================================


======================================================================
EVOLUTION DIAGNOSTICS (t=0 → t=3.445800e-03 → t=3.445800e-02 → t=3.445800e-02)
======================================================================

1. VELOCITY EVOLUTION:
   Max |v^r| at t=0:             0.000e+00
   Max |v^r| at t=3.445800e-03:   2.296e-06
   Max |v^r| at t=3.445800e-02: 2.260e-05

2. CENTRAL DENSITY:
   ρ_c at t=0:                 1.279997e-03
   ρ_c at t=3.445800e-03:   1.279997e-03
   ρ_c at t=3.445800e-02: 1.280000e-03
   Δρ_c/ρ_c (t=3.445800e-03):    2.411e-08
   Δρ_c/ρ_c (t=3.445800e-02):2.353e-06

3. DENSITY ERROR (max over domain):
   Max |Δρ|/ρ at t=3.445800e-03:    5.599e-06
   Max |Δρ|/ρ at t=3.445800e-02: 7.321e-05
   Growth factor (final/1):        13.1x

4. PRESSURE ERROR (max over domain):
   Max |ΔP|/P at t=3.445800e-03:    0.000e+00
   Max |ΔP|/P at t=3.445800e-02: 1.236e-06
   Growth factor (final/1):        0.0x

5. CONS2PRIM STATUS:
   Success at t=0:               700/700
   Success at t=3.445800e-03:   700/700
   Success at t=3.445800e-02: 700/700

======================================================================
Evolution complete. Plots saved:
  1. tov_solution.png                - TOV solution (ρ, P, M, α)
  2. tov_initial_data_comparison.png - TOV vs Initial data at t=0
  3. tov_evolution.png               - Hydro evolution: t=0 → t=3.445800e-03 → t=3.445800e-02
  4. tov_bssn_evolution.png          - BSSN variables: t=0 → t=3.445800e-02 (Cowling check)
======================================================================
/home/yo/repositories/engrenage/examples/TOVEvolution_corrected.py:672: SyntaxWarning: invalid escape sequence '\p'
  axes[1, 1].set_title('Conformal Factor $\phi$')


